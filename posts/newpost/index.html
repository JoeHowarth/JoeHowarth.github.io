<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Understandable Simulations - Joe Howarth</title>
  <meta property="og:title" content="Understandable Simulations" />
  <meta name="twitter:title" content="Understandable Simulations" />
  <meta name="description" content="Understandable Simulations Introduce Problem For those who don&rsquo;t know, I&rsquo;ve been working on historical, agent-based simulations for the past couple years. The nature of the project means there are lots of tensions. - Since it&rsquo;s a system of feedback loops and aims to approximate reality, the models and coefficients relating the systems need lots of tweaking to get into reasonable ranges. - In order to get valid results, I need to run over 1000&rsquo;s of years to ensure I&rsquo;m not just seeing statistical noise - Since there are so many aspects of society and people, I need ways of calculating and exploring all sorts of trends, averages, expected values etc.">
  <meta property="og:description" content="Understandable Simulations Introduce Problem For those who don&rsquo;t know, I&rsquo;ve been working on historical, agent-based simulations for the past couple years. The nature of the project means there are lots of tensions. - Since it&rsquo;s a system of feedback loops and aims to approximate reality, the models and coefficients relating the systems need lots of tweaking to get into reasonable ranges. - In order to get valid results, I need to run over 1000&rsquo;s of years to ensure I&rsquo;m not just seeing statistical noise - Since there are so many aspects of society and people, I need ways of calculating and exploring all sorts of trends, averages, expected values etc.">
  <meta name="twitter:description" content="Understandable Simulations Introduce Problem For those who don&rsquo;t know, I&rsquo;ve been working on historical, agent-based simulations for the past couple years. The nature of the project means …">
  <meta name="author" content="Joe Howarth"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Joe Howarth",
    
    "url": "https:\/\/joehowarth.github.io"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "https:\/\/joehowarth.github.io"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https:\/\/joehowarth.github.io",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "https:\/\/joehowarth.github.io\/posts\/newpost\/",
          "name": "Understandable simulations"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Joe Howarth"
  },
  "headline": "Understandable Simulations",
  "description" : "Understandable Simulations Introduce Problem For those who don\x26rsquo;t know, I\x26rsquo;ve been working on historical, agent-based simulations for the past couple years. The nature of the project means there are lots of tensions. - Since it\x26rsquo;s a system of feedback loops and aims to approximate reality, the models and coefficients relating the systems need lots of tweaking to get into reasonable ranges. - In order to get valid results, I need to run over 1000\x26rsquo;s of years to ensure I\x26rsquo;m not just seeing statistical noise - Since there are so many aspects of society and people, I need ways of calculating and exploring all sorts of trends, averages, expected values etc.",
  "inLanguage" : "en",
  "wordCount":  647 ,
  "datePublished" : "2020-02-26T00:00:00",
  "dateModified" : "2020-02-26T00:00:00",
  "image" : "https:\/\/joehowarth.github.io\/img\/avatar.png",
  "keywords" : [ "" ],
  "mainEntityOfPage" : "https:\/\/joehowarth.github.io\/posts\/newpost\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "https:\/\/joehowarth.github.io",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "https:\/\/joehowarth.github.io\/img\/avatar.png",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>

<meta property="og:title" content="Understandable Simulations" />
<meta property="og:description" content="Understandable Simulations Introduce Problem For those who don&rsquo;t know, I&rsquo;ve been working on historical, agent-based simulations for the past couple years. The nature of the project means there are lots of tensions. - Since it&rsquo;s a system of feedback loops and aims to approximate reality, the models and coefficients relating the systems need lots of tweaking to get into reasonable ranges. - In order to get valid results, I need to run over 1000&rsquo;s of years to ensure I&rsquo;m not just seeing statistical noise - Since there are so many aspects of society and people, I need ways of calculating and exploring all sorts of trends, averages, expected values etc.">
<meta property="og:image" content="https://joehowarth.github.io/img/avatar.png" />
<meta property="og:url" content="https://joehowarth.github.io/posts/newpost/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Joe Howarth" />

  <meta name="twitter:title" content="Understandable Simulations" />
  <meta name="twitter:description" content="Understandable Simulations Introduce Problem For those who don&rsquo;t know, I&rsquo;ve been working on historical, agent-based simulations for the past couple years. The nature of the project means …">
  <meta name="twitter:image" content="https://joehowarth.github.io/img/avatar.png" />
  <meta name="twitter:card" content="summary" />
  <link href='https://joehowarth.github.io/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta property="og:image" content="https://joehowarth.github.io/img/avatar.png" />
  <meta name="twitter:image" content="https://joehowarth.github.io/img/avatar.png" />
  <meta name="twitter:card" content="summary" />
  <meta property="og:url" content="https://joehowarth.github.io/posts/newpost/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Joe Howarth" />

  <meta name="generator" content="Hugo 0.58.3" />
  <link rel="alternate" href="https://joehowarth.github.io/index.xml" type="application/rss+xml" title="Joe Howarth"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><link rel="stylesheet" href="https://joehowarth.github.io/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="https://joehowarth.github.io/css/highlight.min.css" /><link rel="stylesheet" href="https://joehowarth.github.io/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">



  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://joehowarth.github.io">Joe Howarth</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Blog" href="/">Blog</a>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent">Historical Simulation</a>
              <div class="navlinks-children">
                
                  <a href="/posts/populationdesign">Population Design</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="About" href="/page/about/">About</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="/tags">Tags</a>
            </li>
          
        

        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="Joe Howarth" href="https://joehowarth.github.io">
            <img class="avatar-img" src="https://joehowarth.github.io/img/avatar.png" alt="Joe Howarth" />
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="posts-heading">
              
                <h1>Understandable Simulations</h1>
              
              
                <hr class="small">
              
              
              
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        

<h1 id="understandable-simulations">Understandable Simulations</h1>

<h3 id="introduce-problem">Introduce Problem</h3>

<p>For those who don&rsquo;t know, I&rsquo;ve been working on historical, agent-based simulations for the past couple years.
The nature of the project means there are lots of tensions.
- Since it&rsquo;s a system of feedback loops and aims to approximate reality, the models and coefficients relating the systems need lots of tweaking to get into reasonable ranges.
- In order to get valid results, I need to run over 1000&rsquo;s of years to ensure I&rsquo;m not just seeing statistical noise
- Since there are so many aspects of society and people, I need ways of calculating and exploring all sorts of trends, averages, expected values etc.</p>

<p>I first resorted to print statements and computing the relavent analyses ad hoc within the simulations code.
For all the software engineers out there, this should make you vomit; mixing totally separate responsibilities in the same files/function, yuck!
No separation of concerns at all. For the modellers and data scientists, this is a reproducibility nightmare.
Let&rsquo;s say I&rsquo;m looking at average age over time and I notice it seems low. With this methodology in order to dig in more to investigate the cause,
I need to think of the calculation that would give more insight, open the source code, figure out how to being all the relevant data together
into the same place, code the algorithm (usually not the hard part!), then interpret the output. This process takes quite a while from noticing the problem
to getting the relevant data and forget out interpretability, graphs aren&rsquo;t exactly quick and easy at the command line!</p>

<p>Clearly there must be a better way, right?</p>

<p>I initially conceived of these projects as working up to a grand strategy game a-la Civilization or Europa Universalis and kept the game idea in
the architecture. Yet the problems are actually much more data science-y. What if I simply record everything that happens in the simulation and
analyze it after the fact with the great analytics libraries in python??</p>

<p>To do this I first tried writing a simple model in python, but it&rsquo;s far to slow. Back to rust!</p>

<h3 id="simulation-produces-data-product">Simulation Produces Data Product</h3>

<p>Enough rambling, lets dive into how this solution works.</p>

<p>In the simulation code, I want to essentially log semi-raw data during all the major
updates or actions in the system. To do this, each log statement gets a name and
names for all the data values logged. Concretely, if I wanted to record the births and
deaths each season I might name that series <code>pop-birth-deaths</code> and with columns <code>num-births</code>, <code>num-deaths</code>. Then each call would conceptually add a row. The recorder would have many of these series.</p>

<p>This could implemented endless different ways, with the most heavyweight system
being a full SQL database. A major requirement for this system is flexibility and
ease of use rather than long-term maintainability. With that in mind I simply use
one csv file per &lsquo;table&rsquo;/series and create a directory for each run. This is really fast, simple and
 doesn&rsquo;t require heavyweight database client libraries that slow compile times. Here&rsquo;s the concrete</p>

<pre><code class="language-Recorder```">
</code></pre>

<p>rust</p>

<p>fn register(name: impl AsRef<str>, col_names: &amp;[&amp;str]);</p>

<p>fn add(name: &amp;str, blob: impl Serialize + Debug);</p>

<p>fn add_list<T: Serialize + Debug>(name: &amp;str, data: impl Iterator<Item=T>);</p>

<p>pub fn add_structs(name: &amp;str, data: &amp;[impl Serialize + Debug]);</p>

<p>pub fn add_struct(name: &amp;str, data: impl Serialize + Debug);</p>

<p>```</p>

<h2 id="analysis">Analysis</h2>

<h3 id="with-all-this-lovely-data-no-we-can-ask-it-some-questions">With all this lovely data no we can ask it some questions!</h3>

<p>After each simulation run, I load each csv table into a pandas dataframe and store
them into a dictionary. Theis brings easy and iteractive charting and stats to my finger tips
and, since all the raw data is right there, any arbitrarily complex analsis too!</p>

<p>After I got this system up and running I debugged my system more in one day than I had over an
entire month!</p>

<h2 id="takeaway">Takeaway</h2>

<p>Always invest in your tools and don&rsquo;t be afraid to reframe your project/problem!</p>


        

        
            <hr/>
            <section id="social-share">
              <div class="list-inline footer-links">
                

<div class="share-box" aria-hidden="true">
    <ul class="share">
      
      <li>
        <a href="//twitter.com/share?url=https%3a%2f%2fjoehowarth.github.io%2fposts%2fnewpost%2f&amp;text=Understandable%20Simulations&amp;via=" target="_blank" title="Share on Twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//plus.google.com/share?url=https%3a%2f%2fjoehowarth.github.io%2fposts%2fnewpost%2f" target="_blank" title="Share on Google Plus">
          <i class="fab fa-google-plus"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fjoehowarth.github.io%2fposts%2fnewpost%2f" target="_blank" title="Share on Facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//reddit.com/submit?url=https%3a%2f%2fjoehowarth.github.io%2fposts%2fnewpost%2f&amp;title=Understandable%20Simulations" target="_blank" title="Share on Reddit">
          <i class="fab fa-reddit"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fjoehowarth.github.io%2fposts%2fnewpost%2f&amp;title=Understandable%20Simulations" target="_blank" title="Share on LinkedIn">
          <i class="fab fa-linkedin"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.stumbleupon.com/submit?url=https%3a%2f%2fjoehowarth.github.io%2fposts%2fnewpost%2f&amp;title=Understandable%20Simulations" target="_blank" title="Share on StumbleUpon">
          <i class="fab fa-stumbleupon"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fjoehowarth.github.io%2fposts%2fnewpost%2f&amp;description=Understandable%20Simulations" target="_blank" title="Share on Pinterest">
          <i class="fab fa-pinterest"></i>
        </a>
      </li>
    </ul>
  </div>
  
              </div>
            </section>
        

        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="https://joehowarth.github.io/posts/challengingtheplayer/" data-toggle="tooltip" data-placement="top" title="Challenging A Player">&larr; Previous Post</a>
            </li>
          
          
        </ul>
      


      
        
        
      

    </div>
  </div>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="mailto:JosepheHowarth@gmail.com" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.facebook.com/joseph.e.howarth" title="Facebook">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-facebook fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/JoeHowarth" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            <a href="" title="RSS">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              Joe Howarth
            
          

          &nbsp;&bull;&nbsp;&copy;
          
            2020
          

          
            &nbsp;&bull;&nbsp;
            <a href="https://joehowarth.github.io">Joe Howarth</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.58.3</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="https://joehowarth.github.io/js/main.js"></script>
<script src="https://joehowarth.github.io/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> $(document).ready(function() {$("pre.chroma").css("padding","0");}); </script><script> renderMathInElement(document.body); </script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="https://joehowarth.github.io/js/load-photoswipe.js"></script>









  </body>
</html>

